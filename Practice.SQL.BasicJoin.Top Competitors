SELECT F.HACKER_ID, F.NAME
FROM ( SELECT D.HACKER_ID, D.NAME, COUNT(D.HACKER_ID) AS CNT
       FROM SUBMISSIONS A
       INNER JOIN CHALLENGES B ON B.CHALLENGE_ID = A.CHALLENGE_ID
       INNER JOIN DIFFICULTY C ON C.DIFFICULTY_LEVEL = B.DIFFICULTY_LEVEL AND C.SCORE = A.SCORE
       INNER JOIN HACKERS D ON D.HACKER_ID = A.HACKER_ID
       GROUP BY HACKER_ID, NAME
       ) F
WHERE F.CNT > 1
ORDER BY F.CNT DESC, F.HACKER_ID;
